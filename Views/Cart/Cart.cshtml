namespace Veluxe.Views.Home
@model Veluxe.Models.CartModel

@{
    ViewData["Title"] = "Cart";
}

<link rel="stylesheet" href="~/css/cart.css" />

<h2 class="cart">My Cart</h2>
<div class="cart-container">
    <table class="cart-table">
        <thead>
            <tr>
                <th>Item</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            @if (Model == null || !Model.Cart_Products.Any())
            {
                <tr>
                    <td colspan="5">Your cart is empty</td>
                </tr>
            }
            else
            {
                foreach (var item in Model.Cart_Products)
                {
                    <tr>
                        <td>
                            <img src="~/assets/@item.Products.image_url" alt="@item.Products.product_name" class="cart-img" />
                            <h6>@item.Products.product_name</h6>
                        </td>

                        <td>Rs. @item.Products.price.ToString("0.00")</td>

                        <td>
                            <form asp-controller="Cart" asp-action="UpdateQuantity" method="post">
                                <input type="hidden" name="productId" value="@item.product_id" />
                                <input type="number" name="quantity" value="@item.quantity" min="1" class="qty-input"
                                       onchange="this.form.submit()" />
                            </form>
                        </td>

                        <td>Rs. @item.total_price.ToString("0.00")</td>

                        <td>
                            <a asp-controller="Cart" asp-action="Remove" asp-route-productId="@item.product_id" class="remove-btn">X</a>
                        </td>
                    </tr>
                }
            }
        </tbody>
    </table>

    @if (Model != null && Model.Cart_Products.Any())
    {
        decimal subtotal = Model.grand_total;
        decimal delivery = 100;

        <div class="cart-summary">
            <h3>Subtotal: Rs. @subtotal.ToString("0.00")</h3>
            <h5>Delivery Charge: Rs. @delivery.ToString("0.00")</h5>
            <h3>Total: Rs. @(subtotal + delivery)</h3>
            <a href="/Checkout/Checkout" class="checkout-btn">Proceed to Checkout</a>
        </div>
    }
</div>